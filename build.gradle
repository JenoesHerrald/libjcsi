/*
 * This build file was generated by the Gradle 'init' task.
 *
 * This generated file contains a sample Java Library project to get you started.
 * For more details take a look at the Java Libraries chapter in the Gradle
 * user guide available at https://docs.gradle.org/3.5/userguide/java_library_plugin.html
 */

// Apply the java-library plugin to add support for Java Library
apply plugin: 'java-library'

// In this section you declare where to find the dependencies of your project
repositories {
	// Use jcenter for resolving your dependencies.
	// You can declare any Maven/Ivy/file repository here.
	jcenter()

}

dependencies {
	// This dependency is exported to consumers, that is to say found on their compile classpath.
	api 'org.apache.commons:commons-math3:3.6.1'

	// This dependency is used internally, and not exposed to consumers on their own compile classpath.
	implementation 'com.google.guava:guava:21.0'

	compile files('lib/jcurses-x.jar')

	//junit 4
	testCompile 'junit:junit:4.12'

}

//from https://oliverveits.wordpress.com/2016/11/15/how-to-build-a-lean-jar-file-with-gradle/

jar {
	// exclude log properties (recommended)
	exclude ("log4j.properties")
	
	manifest {
	attributes (
		// add classpath to Manifest; see http://stackoverflow.com/questions/30087427/add-classpath-in-manifest-file-of-jar-in-gradle
		"Class-Path": '. dependency-jars/' + configurations.compile.collect { it.getName() }.join(' dependency-jars/')
		)
	}
}

task packLibsForJar (type: Copy) {
	def toDir = "build/libs/dependency-jars"

	// create directories, if not already done:
	file(toDir).mkdirs()

	// copy jars to lib folder:
	from configurations.compile
	into toDir

}

jar.dependsOn packLibsForJar
